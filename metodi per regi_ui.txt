from PyQt5.QtGui import QColor, QIcon
import regi_db
    ### IN QUESTO ORDINE!!!
        self.stackedWidget.setCurrentIndex(0)
        palette_preventivi = QtGui.QPalette()
        palette_preventivi.setColor(QtGui.QPalette.Background, QColor("#ccfff0"))
        self.groupBox.setPalette(palette_preventivi)
        self.tab_dettaglio_totale.setPalette(palette_preventivi)
        palette_clienti = QtGui.QPalette()
        palette_clienti.setColor(QtGui.QPalette.Background, QColor("#ccf0ff"))
        self.groupBox_2.setPalette(palette_clienti)
        self.pag_1.setPalette(palette_clienti)
        palette_progetti = QtGui.QPalette()
        palette_progetti.setColor(QtGui.QPalette.Background, QColor("#f0ffcc"))
        self.groupBox_3.setPalette(palette_progetti)
        self.tree_progetti.setPalette(palette_progetti)

        self.current_cliente = {"cognome": '', "nome": '', "via": '', "comune": "", "tel1": '', "tel2": '', "email": '', "cantiere": ''}
        self.current_prev = {}

        self.btn_nuovo_prev.clicked.connect(self.view_db_clienti)
        self.btn_view_anagrafica.clicked.connect(self.view_anagrafica)
        self.btn_scegli_cliente.clicked.connect(self.crea_prev)

    def view_db_clienti(self):
        self.stackedWidget.setCurrentIndex(1)
        query = regi_db.Cliente.select().dicts()
        for num_riga, cliente in enumerate(query):
            self.tab_clienti.insertRow(num_riga)
            for num_colonna, dato in enumerate(cliente.values()):
                if num_colonna == 0:
                    continue # evita la colonna id
                if dato == None:
                    dato = "Nessuno"
                self.tab_clienti.setItem(num_riga, num_colonna-1, QtWidgets.QTableWidgetItem(str(dato)))
    def view_anagrafica(self):
        self.view_db_clienti()
        self.label_2.enabled = False
        self.btn_scegli_cliente.enabled = False
    def crea_prev(self):
        self.current_cliente = {"cognome": 'Dimaglie', "nome": 'Gregorio', "via": 'via C. Golgi, 33', "comune": 'Manduria (TA)', "tel1": 'Nessuno', "tel2": 'Nessuno', "email": 'Nessuno', "cantiere": 'Nessuno'}
        if self.tab_clienti.selectedItems() == []:
            print("Nessun elemento selezionato")
        else:
            for current_item, key in zip(self.tab_clienti.selectedItems(), self.current_cliente):
                    print(current_item.text(), key)
                    self.current_cliente[key] = current_item.text()
            print(self.current_cliente)
            self.stackedWidget.setCurrentIndex(2)
            self.line_prev_cantiere = self.current_cliente["cantiere"]
            self.line_prev_comune = "{comune}".format(**self.current_cliente)
            self.line_prev_email = "{email}".format(**self.current_cliente)
            self.line_prev_via = "{via}".format(**self.current_cliente)
            self.line_prev_nome = "{cognome} {nome}".format(**self.current_cliente)
            self.line_prev_tel1 = "{tel1}".format(**self.current_cliente)
            self.line_prev_tel2 = "{tel2}".format(**self.current_cliente)
            self.line_prev_nome1 = "{cognome} {nome}".format(**self.current_cliente)

### ALLA FINE:
    # reGI = QtWidgets.QMainWindow()
    reGI.setWindowTitle("reGI a0.3.0") # non funge
    reGI.setWindowIcon(QtGui.QIcon("icon_0.png")) # funge
    # sys.exit(app.exec_())
    regi_db.db.close()